

Auth flow:

client -> server: REGISTER_USER: email, hashed_password
  client: {
    user: {
      id: 1
      username: test_name
      registered: false
    }
  }
  server: {
    pending_users: [{
      id: 1
      username: test_name
    }
    registered_users: []
  }]
server -> email: CONFIRM_EMAIL_FOR_USER, email

email -> server: CONFIRM_EMAIL_FOR_USER, email
  server: {
    pending_users: []
    registered_users: [
      {
        id: 1
        username: test_name
      }
    ]
  }


client -> server: LOGIN, email, hashed_password
  server: {
    sessions: [
      {
        id: 1
        username: test_name
        start: time.now
      }
    ]
  }

server-> client: if good password, ACCEPT_LOGIN, email, session_token
 client :{
  user: {
    registered: true
    session_token
  }
 }